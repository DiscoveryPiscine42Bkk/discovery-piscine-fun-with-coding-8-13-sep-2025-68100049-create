
window.onload = function () {
  let saved = getCookie("todo");
  if (saved) {
    let list = JSON.parse(saved);
    list.forEach(item => add(item, false));
  }
};

document.getElementById("newBtn").onclick = function () {
  let text = prompt("New TO DO:");
  if (text && text.trim() !== "") add(text.trim(), true);
};

function add(text, save = true) {
  let list = document.getElementById("ft_list");
  let div = document.createElement("div");
  div.innerHTML = text;

  div.onclick = function () {
    if (confirm("Remove?")) {
      list.removeChild(div);
      update();
    }
  };

  list.insertBefore(div, list.firstChild);
  if (save) update();
}

function update() {
  let items = [];
  document.querySelectorAll("#ft_list div").forEach(d => items.push(d.innerHTML));
  setCookie("todo", JSON.stringify(items), 7);
}

function setCookie(name, value, days) {
  let d = new Date();
  d.setTime(d.getTime() + (days*24*60*60*1000));
  document.cookie = name + "=" + value + ";expires=" + d.toUTCString() + ";path=/";
}

function getCookie(name) {
  let cname = name + "=";
  let ca = document.cookie.split(';');
  for (let c of ca) {
    c = c.trim();
    if (c.indexOf(cname) === 0) return c.substring(cname.length);
  }
  return "";
}
